---
title:  "[2022810089] ì´ì›í‘œ 7ì°¨ê³¼ì œ-1"
excerpt: "md íŒŒì¼ì— ë§ˆí¬ë‹¤ìš´ ë¬¸ë²•ìœ¼ë¡œ ì‘ì„±í•˜ì—¬ Github ì›ê²© ì €ì¥ì†Œì— ì—…ë¡œë“œ í•´ë³´ì. ì—ë””í„°ëŠ” Visual Studio code ì‚¬ìš©! ë¡œì»¬ ì„œë²„ì—ì„œ í™•ì¸ë„ í•´ë³´ì. "

categories:
  - Blog
tags:
  - [Blog, jekyll, Github, Git]

toc: true
toc_sticky: true
 
date: 2020-05-25
last_modified_at: 2020-05-25
---
# ë¶„ë¥˜ ì†Œê°œ

ì´ 4ê°œì˜ ê°•ì˜ì—ì„œëŠ” í´ë˜ì‹ ë¨¸ì‹  ëŸ¬ë‹ì˜ ê¸°ë³¸ ì´ˆì ì¸ _ë¶„ë¥˜_ë¥¼ íƒêµ¬í•  ê²ƒì…ë‹ˆë‹¤. ìš°ë¦¬ëŠ” ì•„ì‹œì•„ì™€ ì¸ë„ì˜ ëª¨ë“  í›Œë¥­í•œ ìš”ë¦¬ì— ëŒ€í•œ ë°ì´í„° ì„¸íŠ¸ì™€ í•¨ê»˜ ë‹¤ì–‘í•œ ë¶„ë¥˜ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ì—¬ ì•ˆë‚´í•  ê²ƒì…ë‹ˆë‹¤. ë‹¹ì‹ ì´ ë°°ê³ í”ˆ í¬ë§!

![just a pinch!](pinch.png)

> ì´ ìˆ˜ì—…ì—ì„œ ë²”ì•„ì‹œì•„ ìš”ë¦¬ë¥¼ ì¦ê²¨ë³´ì„¸ìš”!Image by [Jen Looper](https://twitter.com/jenlooper)

ë¶„ë¥˜ëŠ” ë‹¤ìŒê³¼ ê°™ì€ í˜•ì‹ì…ë‹ˆë‹¤. [supervised learning](https://wikipedia.org/wiki/Supervised_learning) íšŒê·€ ê¸°ìˆ ê³¼ ë§ì€ ê³µí†µì ì´ ìˆìŠµë‹ˆë‹¤. ë¨¸ì‹  ëŸ¬ë‹ì´ ë°ì´í„° ì„¸íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ë¬¼ì— ëŒ€í•œ ê°’ì´ë‚˜ ì´ë¦„ì„ ì˜ˆì¸¡í•˜ëŠ” ê²ƒì´ë¼ë©´ ì¼ë°˜ì ìœ¼ë¡œ ë¶„ë¥˜ëŠ” _ì´ì§„ ë¶„ë¥˜_ ë° _ë‹¤ì¤‘ í´ë˜ìŠ¤ ë¶„ë¥˜_ì˜ ë‘ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ë‰©ë‹ˆë‹¤.

[![Introduction to classification](https://img.youtube.com/vi/eg8DJYwdMyg/0.jpg)](https://youtu.be/eg8DJYwdMyg "Introduction to classification")

> ğŸ¥ ë¹„ë””ì˜¤ë¥¼ ë³´ë ¤ë©´ ìœ„ì˜ ì´ë¯¸ì§€ë¥¼ í´ë¦­í•˜ì‹­ì‹œì˜¤: MITì˜ John Guttagê°€ ë¶„ë¥˜ë¥¼ ì†Œê°œí•©ë‹ˆë‹¤.

ê¸°ì–µí•˜ë‹¤:

- **ì„ í˜• íšŒê·€**ëŠ” ë³€ìˆ˜ ê°„ì˜ ê´€ê³„ë¥¼ ì˜ˆì¸¡í•˜ê³  í•´ë‹¹ ì„ ê³¼ì˜ ê´€ê³„ì—ì„œ ìƒˆ ë°ì´í„° í¬ì¸íŠ¸ê°€ ì†í•˜ëŠ” ìœ„ì¹˜ì— ëŒ€í•œ ì •í™•í•œ ì˜ˆì¸¡ì„ í•˜ëŠ” ë° ë„ì›€ì´ ë˜ì—ˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ 9ì›”ê³¼ 12ì›”ì˜ í˜¸ë°• ê°€ê²©ì€ ì–¼ë§ˆì¸ì§€ ì˜ˆì¸¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **ë¡œì§€ìŠ¤í‹± íšŒê·€**ëŠ” "ì´ì§„ ì¹´í…Œê³ ë¦¬"ë¥¼ ì°¾ëŠ” ë° ë„ì›€ì´ ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ ê°€ê²©ëŒ€ì—ì„œ _ì´ í˜¸ë°•ì€ ì£¼í™©ìƒ‰ì…ë‹ˆê¹Œ ì•„ë‹ˆë©´ ì£¼í™©ìƒ‰ì´ ì•„ë‹™ë‹ˆë‹¤_?


ë¶„ë¥˜ëŠ” ë‹¤ì–‘í•œ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„° í¬ì¸íŠ¸ì˜ ë ˆì´ë¸” ë˜ëŠ” í´ë˜ìŠ¤ë¥¼ ê²°ì •í•˜ëŠ” ë‹¤ë¥¸ ë°©ë²•ì„ ê²°ì •í•©ë‹ˆë‹¤. ì´ ìš”ë¦¬ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¬ë£Œ ê·¸ë£¹ì„ ê´€ì°°í•˜ì—¬ ì›ì‚°ì§€ ìš”ë¦¬ë¥¼ ê²°ì •í•  ìˆ˜ ìˆëŠ”ì§€ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

## [Pre-lecture quiz](https://white-water-09ec41f0f.azurestaticapps.net/quiz/19/)

> ### [This lesson is available in R!](./solution/R/lesson_10-R.ipynb)

### ì†Œê°œ

ë¶„ë¥˜ëŠ” ê¸°ê³„ í•™ìŠµ ì—°êµ¬ì› ë° ë°ì´í„° ê³¼í•™ìì˜ ê¸°ë³¸ í™œë™ ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤. ì´ì§„ ê°’ì˜ ê¸°ë³¸ ë¶„ë¥˜("ì´ ì´ë©”ì¼ì€ ìŠ¤íŒ¸ì…ë‹ˆê¹Œ?")ì—ì„œ ì»´í“¨í„° ë¹„ì „ì„ ì‚¬ìš©í•œ ë³µì¡í•œ ì´ë¯¸ì§€ ë¶„ë¥˜ ë° ì„¸ë¶„í™”ì— ì´ë¥´ê¸°ê¹Œì§€ ë°ì´í„°ë¥¼ í´ë˜ìŠ¤ë¡œ ë¶„ë¥˜í•˜ê³  ì§ˆë¬¸í•  ìˆ˜ ìˆëŠ” ê²ƒì€ í•­ìƒ ìœ ìš©í•©ë‹ˆë‹¤.

ë³´ë‹¤ ê³¼í•™ì ì¸ ë°©ì‹ìœ¼ë¡œ í”„ë¡œì„¸ìŠ¤ë¥¼ ì„¤ëª…í•˜ê¸° ìœ„í•´ ë¶„ë¥˜ ë°©ë²•ì€ ì…ë ¥ ë³€ìˆ˜ ê°„ì˜ ê´€ê³„ë¥¼ ì¶œë ¥ ë³€ìˆ˜ì— ë§¤í•‘í•  ìˆ˜ ìˆëŠ” ì˜ˆì¸¡ ëª¨ë¸ì„ ìƒì„±í•©ë‹ˆë‹¤.

![binary vs. multiclass classification](binary-multiclass.png)

> ì²˜ë¦¬í•  ë¶„ë¥˜ ì•Œê³ ë¦¬ì¦˜ì— ëŒ€í•œ ì´ì§„ ëŒ€ ë‹¤ì¤‘ í´ë˜ìŠ¤ ë¬¸ì œ. Infographic by [Jen Looper](https://twitter.com/jenlooper)


ë°ì´í„° ì •ë¦¬, ì‹œê°í™” ë° ML ì‘ì—…ì„ ìœ„í•œ ì¤€ë¹„ í”„ë¡œì„¸ìŠ¤ë¥¼ ì‹œì‘í•˜ê¸° ì „ì— ë¨¸ì‹  ëŸ¬ë‹ì„ í™œìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ë¶„ë¥˜í•  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

[statistics](https://wikipedia.org/wiki/Statistical_classification), ê¸°ì¡´ ê¸°ê³„ í•™ìŠµì„ ì‚¬ìš©í•œ ë¶„ë¥˜ëŠ” 'í¡ì—°ì', 'ì²´ì¤‘', 'ë‚˜ì´'ì™€ ê°™ì€ íŠ¹ì„±ì„ ì‚¬ìš©í•˜ì—¬ _Xë³‘ ë°œë³‘ ê°€ëŠ¥ì„±_ì„ ê²°ì •í•©ë‹ˆë‹¤. ì´ì „ì— ìˆ˜í–‰í•œ íšŒê·€ ì—°ìŠµê³¼ ìœ ì‚¬í•œ ì§€ë„ í•™ìŠµ ê¸°ìˆ ë¡œ ë°ì´í„°ì— ë ˆì´ë¸”ì´ ì§€ì •ë˜ê³  ML ì•Œê³ ë¦¬ì¦˜ì€ í•´ë‹¹ ë ˆì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„° ì„¸íŠ¸ì˜ í´ë˜ìŠ¤(ë˜ëŠ” 'íŠ¹ì„±')ë¥¼ ë¶„ë¥˜ ë° ì˜ˆì¸¡í•˜ê³  ê·¸ë£¹ ë˜ëŠ” ê²°ê³¼ì— í• ë‹¹í•©ë‹ˆë‹¤.

âœ… ì ì‹œ ì‹œê°„ì„ ë‚´ì–´ ìš”ë¦¬ì— ëŒ€í•œ ë°ì´í„° ì„¸íŠ¸ë¥¼ ìƒìƒí•´ ë³´ì‹­ì‹œì˜¤. ë‹¤ì¤‘ í´ë˜ìŠ¤ ëª¨ë¸ì€ ë¬´ì—‡ì— ë‹µí•  ìˆ˜ ìˆìŠµë‹ˆê¹Œ? ì´ì§„ ëª¨ë¸ì€ ë¬´ì—‡ì— ë‹µí•  ìˆ˜ ìˆìŠµë‹ˆê¹Œ? íŠ¹ì • ìš”ë¦¬ì— í˜¸ë¡œíŒŒë¥¼ ì‚¬ìš©í•  ê°€ëŠ¥ì„±ì´ ìˆëŠ”ì§€ í™•ì¸í•˜ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í•©ë‹ˆê¹Œ? ìŠ¤íƒ€ ì•„ë‹ˆìŠ¤, ì•„í‹°ì´ˆí¬, ì½œë¦¬í”Œë¼ì›Œ, ì™€ì‚¬ë¹„ë¡œ ê°€ë“ ì°¬ ì‹ë£Œí’ˆ ê°€ë°©ì„ ì„ ë¬¼ë¡œ ì£¼ì–´ ì „í˜•ì ì¸ ì¸ë„ ìš”ë¦¬ë¥¼ ë§Œë“¤ ìˆ˜ ìˆëŠ”ì§€ ì•Œê³  ì‹¶ë‹¤ë©´?

[![Crazy mystery baskets](https://img.youtube.com/vi/GuTeDbaNoEU/0.jpg)](https://youtu.be/GuTeDbaNoEU "Crazy mystery baskets")

> ğŸ¥ ë™ì˜ìƒì„ ë³´ë ¤ë©´ ìœ„ì˜ ì´ë¯¸ì§€ë¥¼ í´ë¦­í•˜ì„¸ìš”. ì‡¼ 'ì´™'ì˜ ì „ì œëŠ” ì…°í”„ê°€ ë¬´ì‘ìœ„ë¡œ ì„ íƒí•œ ì¬ë£Œë¡œ ìš”ë¦¬ë¥¼ ë§Œë“¤ì–´ì•¼ í•˜ëŠ” 'ë¯¸ìŠ¤í„°ë¦¬ ë°”êµ¬ë‹ˆ'ì…ë‹ˆë‹¤. í™•ì‹¤íˆ ML ëª¨ë¸ì´ ë„ì›€ì´ ë˜ì—ˆì„ ê²ƒì…ë‹ˆë‹¤!

## ë¶„ë¥˜ì


ì´ ìš”ë¦¬ ë°ì´í„° ì„¸íŠ¸ì— ëŒ€í•´ ë¬»ê³  ì‹¶ì€ ì§ˆë¬¸ì€ ì‹¤ì œë¡œ **ë‹¤ì¤‘ í´ë˜ìŠ¤ ì§ˆë¬¸**ì…ë‹ˆë‹¤. ì‘ì—…í•  ìˆ˜ ìˆëŠ” ì ì¬ì  êµ­ê°€ ìš”ë¦¬ê°€ ì—¬ëŸ¬ ê°œ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ì¬ë£Œ ë°°ì¹˜ê°€ ì£¼ì–´ì§€ë©´ ì´ ë§ì€ í´ë˜ìŠ¤ ì¤‘ ë°ì´í„°ê°€ ë§ëŠ” ê²ƒì€ ë¬´ì—‡ì…ë‹ˆê¹Œ?


Scikit-learnì€ í•´ê²°í•˜ë ¤ëŠ” ë¬¸ì œì˜ ì¢…ë¥˜ì— ë”°ë¼ ë°ì´í„°ë¥¼ ë¶„ë¥˜í•˜ëŠ” ë° ì‚¬ìš©í•  ì—¬ëŸ¬ ì•Œê³ ë¦¬ì¦˜ì„ ì œê³µí•©ë‹ˆë‹¤. ë‹¤ìŒ ë‘ ê°•ì˜ì—ì„œëŠ” ì´ëŸ¬í•œ ì•Œê³ ë¦¬ì¦˜ ì¤‘ ëª‡ ê°€ì§€ì— ëŒ€í•´ ë°°ì›ë‹ˆë‹¤.

## ë°ì´í„° ì •ë¦¬ ë° ê· í˜• ì¡°ì •

ì´ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•˜ê¸° ì „ì— ê°€ì¥ ë¨¼ì € í•´ì•¼ í•  ì¼ì€ ë°ì´í„°ë¥¼ ì •ë¦¬í•˜ê³  **ê· í˜•ì„ ì¡°ì •**í•˜ì—¬ ë” ë‚˜ì€ ê²°ê³¼ë¥¼ ì–»ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ í´ë”ì˜ ë£¨íŠ¸ì— ìˆëŠ” ë¹ˆ _notebook.ipynb_ íŒŒì¼ë¡œ ì‹œì‘í•©ë‹ˆë‹¤.


ê°€ì¥ ë¨¼ì € ì„¤ì¹˜í•´ì•¼ í•  ê²ƒì€ [imblearn](https://imbalanced-learn.org/stable/). ì´ê²ƒì€ ë°ì´í„°ì˜ ê· í˜•ì„ ë” ì˜ ë§ì¶œ ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” Scikit-learn íŒ¨í‚¤ì§€ì…ë‹ˆë‹¤(ì´ ì‘ì—…ì— ëŒ€í•œ ìì„¸í•œ ë‚´ìš©ì€ 1ë¶„ ë‚´ë¡œ ë°°ìš°ê²Œ ë©ë‹ˆë‹¤).

1. `imblearn`ì„ ì„¤ì¹˜í•˜ë ¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ `pip install`ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.

    ```python
    pip install imblearn
    ```

2. ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê³  ì‹œê°í™”í•˜ëŠ” ë° í•„ìš”í•œ íŒ¨í‚¤ì§€ë¥¼ ê°€ì ¸ì˜¤ê³  `imblearn`ì—ì„œ `SMOTE`ë„ ê°€ì ¸ì˜µë‹ˆë‹¤.

    ```python
    import pandas as pd
    import matplotlib.pyplot as plt
    import matplotlib as mpl
    import numpy as np
    from imblearn.over_sampling import SMOTE
    ```

ì´ì œ ë‹¤ìŒì— ë°ì´í„° ê°€ì ¸ì˜¤ê¸°ë¥¼ ì½ë„ë¡ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.

3. ë‹¤ìŒ ì‘ì—…ì€ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²ƒì…ë‹ˆë‹¤

    ```python
    df  = pd.read_csv('../data/cuisines.csv')
    ```


`read_csv()`ë¥¼ ì‚¬ìš©í•˜ë©´ csv íŒŒì¼ _cusines.csv_ì˜ ë‚´ìš©ì„ ì½ê³  ë³€ìˆ˜ `df`ì— ë°°ì¹˜í•©ë‹ˆë‹¤.

4. ë°ì´í„°ì˜ ëª¨ì–‘ì„ í™•ì¸í•˜ì‹­ì‹œì˜¤.

    ```python
    df.head()
    ```

   
ì²˜ìŒ 5ê°œ í–‰ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

    ```output
    |     | Unnamed: 0 | cuisine | almond | angelica | anise | anise_seed | apple | apple_brandy | apricot | armagnac | ... | whiskey | white_bread | white_wine | whole_grain_wheat_flour | wine | wood | yam | yeast | yogurt | zucchini |
    | --- | ---------- | ------- | ------ | -------- | ----- | ---------- | ----- | ------------ | ------- | -------- | --- | ------- | ----------- | ---------- | ----------------------- | ---- | ---- | --- | ----- | ------ | -------- |
    | 0   | 65         | indian  | 0      | 0        | 0     | 0          | 0     | 0            | 0       | 0        | ... | 0       | 0           | 0          | 0                       | 0    | 0    | 0   | 0     | 0      | 0        |
    | 1   | 66         | indian  | 1      | 0        | 0     | 0          | 0     | 0            | 0       | 0        | ... | 0       | 0           | 0          | 0                       | 0    | 0    | 0   | 0     | 0      | 0        |
    | 2   | 67         | indian  | 0      | 0        | 0     | 0          | 0     | 0            | 0       | 0        | ... | 0       | 0           | 0          | 0                       | 0    | 0    | 0   | 0     | 0      | 0        |
    | 3   | 68         | indian  | 0      | 0        | 0     | 0          | 0     | 0            | 0       | 0        | ... | 0       | 0           | 0          | 0                       | 0    | 0    | 0   | 0     | 0      | 0        |
    | 4   | 69         | indian  | 0      | 0        | 0     | 0          | 0     | 0            | 0       | 0        | ... | 0       | 0           | 0          | 0                       | 0    | 0    | 0   | 0     | 1      | 0        |
    ```


5. `info()`ë¥¼ í˜¸ì¶œí•˜ì—¬ ì´ ë°ì´í„°ì— ëŒ€í•œ ì •ë³´ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

    ```python
    df.info()
    ```

   ë‹¹ì‹ ì˜ ì•„ì›ƒì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

    ```output
    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 2448 entries, 0 to 2447
    Columns: 385 entries, Unnamed: 0 to zucchini
    dtypes: int64(384), object(1)
    memory usage: 7.2+ MB
    ```

## ìš”ë¦¬ì— ëŒ€í•´ ë°°ìš°ê¸°

ì´ì œ ì‘ì—…ì´ ë” í¥ë¯¸ë¡œì›Œì§€ê¸° ì‹œì‘í•©ë‹ˆë‹¤. ìš”ë¦¬ë³„ ë°ì´í„° ë¶„í¬ë¥¼ ì•Œì•„ë³´ì


1. `barh()`ë¥¼ í˜¸ì¶œí•˜ì—¬ ë°ì´í„°ë¥¼ ë§‰ëŒ€ë¡œ í”Œë¡œíŒ…í•©ë‹ˆë‹¤.

    ```python
    df.cuisine.value_counts().plot.barh()
    ```

    ![cuisine data distribution](cuisine-dist.png)

ìš”ë¦¬ì˜ ìˆ˜ëŠ” ìœ í•œí•˜ì§€ë§Œ ë°ì´í„° ë¶„í¬ê°€ ê³ ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. ë‹¹ì‹ ì€ ê·¸ê²ƒì„ ê³ ì¹  ìˆ˜ ìˆìŠµë‹ˆë‹¤! ê·¸ë ‡ê²Œ í•˜ê¸° ì „ì— ì¡°ê¸ˆ ë” íƒìƒ‰í•˜ì‹­ì‹œì˜¤.


2. ìš”ë¦¬ë³„ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ì˜ ì–‘ì„ í™•ì¸í•˜ê³  ì¸ì‡„í•©ë‹ˆë‹¤.

    ```python
    thai_df = df[(df.cuisine == "thai")]
    japanese_df = df[(df.cuisine == "japanese")]
    chinese_df = df[(df.cuisine == "chinese")]
    indian_df = df[(df.cuisine == "indian")]
    korean_df = df[(df.cuisine == "korean")]
    
    print(f'thai df: {thai_df.shape}')
    print(f'japanese df: {japanese_df.shape}')
    print(f'chinese df: {chinese_df.shape}')
    print(f'indian df: {indian_df.shape}')
    print(f'korean df: {korean_df.shape}')
    ```

   ì¶œë ¥ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

    ```output
    thai df: (289, 385)
    japanese df: (320, 385)
    chinese df: (442, 385)
    indian df: (598, 385)
    korean df: (799, 385)
    ```

## ì„±ë¶„ ë°œê²¬


ì´ì œ ë°ì´í„°ë¥¼ ë” ìì„¸íˆ ì‚´í´ë³´ê³  ìš”ë¦¬ë³„ ì¼ë°˜ì ì¸ ì¬ë£Œê°€ ë¬´ì—‡ì¸ì§€ ì•Œì•„ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìš”ë¦¬ ê°„ì— í˜¼ë™ì„ ì¼ìœ¼í‚¤ëŠ” ë°˜ë³µë˜ëŠ” ë°ì´í„°ë¥¼ ì •ë¦¬í•´ì•¼ í•˜ë¯€ë¡œ ì´ ë¬¸ì œì— ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.


1. Pythonì—ì„œ 'create_ingredient()' í•¨ìˆ˜ë¥¼ ìƒì„±í•˜ì—¬ ì„±ë¶„ ë°ì´í„° í”„ë ˆì„ì„ ìƒì„±í•©ë‹ˆë‹¤. ì´ ê¸°ëŠ¥ì€ ë„ì›€ì´ ë˜ì§€ ì•ŠëŠ” ì—´ì„ ì‚­ì œí•˜ì—¬ ì‹œì‘í•˜ê³  ê°œìˆ˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¬ë£Œë¥¼ ì •ë ¬í•©ë‹ˆë‹¤.

    ```python
    def create_ingredient_df(df):
        ingredient_df = df.T.drop(['cuisine','Unnamed: 0']).sum(axis=1).to_frame('value')
        ingredient_df = ingredient_df[(ingredient_df.T != 0).any()]
        ingredient_df = ingredient_df.sort_values(by='value', ascending=False,
        inplace=False)
        return ingredient_df
    ```

   
ì´ì œ í•´ë‹¹ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ ìš”ë¦¬ë³„ë¡œ ê°€ì¥ ì¸ê¸° ìˆëŠ” ìƒìœ„ 10ê°œ ì¬ë£Œì— ëŒ€í•œ ì•„ì´ë””ì–´ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

2. `create_ingredient()`ë¥¼ í˜¸ì¶œí•˜ê³  `barh()`ë¥¼ í˜¸ì¶œí•˜ì—¬ í”Œë¡¯í•©ë‹ˆë‹¤.

    ```python
    thai_ingredient_df = create_ingredient_df(thai_df)
    thai_ingredient_df.head(10).plot.barh()
    ```

    ![thai](thai.png)

3. ì¼ë³¸ ë°ì´í„°ì— ëŒ€í•´ì„œë„ ë™ì¼í•œ ì‘ì—…ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

    ```python
    japanese_ingredient_df = create_ingredient_df(japanese_df)
    japanese_ingredient_df.head(10).plot.barh()
    ```

    ![japanese](japanese.png)


4. ì´ì œ ì¤‘êµ­ ì¬ë£Œ:

    ```python
    chinese_ingredient_df = create_ingredient_df(chinese_df)
    chinese_ingredient_df.head(10).plot.barh()
    ```

    ![chinese](chinese.png)


5. ì¸ë„ ì¬ë£Œë¥¼ í”Œë¡œíŒ…í•©ë‹ˆë‹¤.

    ```python
    indian_ingredient_df = create_ingredient_df(indian_df)
    indian_ingredient_df.head(10).plot.barh()
    ```

    ![indian](indian.png)

6. ë§ˆì§€ë§‰ìœ¼ë¡œ í•œêµ­ ì¬ë£Œë¥¼ í”Œë¡¯í•©ë‹ˆë‹¤.

    ```python
    korean_ingredient_df = create_ingredient_df(korean_df)
    korean_ingredient_df.head(10).plot.barh()
    ```

    ![korean](korean.png)


7. ì´ì œ `drop()`ì„ í˜¸ì¶œí•˜ì—¬ ê³ ìœ í•œ ìš”ë¦¬ ê°„ì— í˜¼ë™ì„ ì¼ìœ¼í‚¤ëŠ” ê°€ì¥ ì¼ë°˜ì ì¸ ì¬ë£Œë¥¼ ì‚­ì œí•©ë‹ˆë‹¤.

  
ìŒ€, ë§ˆëŠ˜, ìƒê°•ì€ ëˆ„êµ¬ë‚˜ ì¢‹ì•„í•©ë‹ˆë‹¤!

    ```python
    feature_df= df.drop(['cuisine','Unnamed: 0','rice','garlic','ginger'], axis=1)
    labels_df = df.cuisine #.unique()
    feature_df.head()
    ```

## ë°ì´í„°ì„¸íŠ¸ ê· í˜• ì¡°ì •


ì´ì œ ë°ì´í„°ë¥¼ ì •ë¦¬í–ˆìœ¼ë¯€ë¡œ, ì‚¬ìš© [SMOTE](https://imbalanced-learn.org/dev/references/generated/imblearn.over_sampling.SMOTE.html) - "Synthetic Minority Over-sampling Technique" - ê· í˜•ì„ ìœ ì§€í•©ë‹ˆë‹¤.

1. `fit_resample()`ì„ í˜¸ì¶œí•©ë‹ˆë‹¤. ì´ ì „ëµì€ ë³´ê°„ë²•ìœ¼ë¡œ ìƒˆ â€‹â€‹ìƒ˜í”Œì„ ìƒì„±í•©ë‹ˆë‹¤.

    ```python
    oversample = SMOTE()
    transformed_feature_df, transformed_label_df = oversample.fit_resample(feature_df, labels_df)
    ```

ë°ì´í„°ì˜ ê· í˜•ì„ ë§ì¶”ë©´ ë¶„ë¥˜í•  ë•Œ ë” ë‚˜ì€ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ì§„ ë¶„ë¥˜ì— ëŒ€í•´ ìƒê°í•´ ë³´ì‹­ì‹œì˜¤. ëŒ€ë¶€ë¶„ì˜ ë°ì´í„°ê°€ í•˜ë‚˜ì˜ í´ë˜ìŠ¤ì¸ ê²½ìš° ML ëª¨ë¸ì€ í•´ë‹¹ í´ë˜ìŠ¤ì— ëŒ€í•œ ë°ì´í„°ê°€ ë” ë§ê¸° ë•Œë¬¸ì— í•´ë‹¹ í´ë˜ìŠ¤ë¥¼ ë” ìì£¼ ì˜ˆì¸¡í•©ë‹ˆë‹¤. ë°ì´í„° ê· í˜•ì„ ë§ì¶”ë©´ ì™œê³¡ëœ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ ì´ëŸ¬í•œ ë¶ˆê· í˜•ì„ ì œê±°í•˜ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤.

2. ì´ì œ ì„±ë¶„ë³„ ë¼ë²¨ ìˆ˜ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

    ```python
    print(f'new label count: {transformed_label_df.value_counts()}')
    print(f'old label count: {df.cuisine.value_counts()}')
    ```

ì¶œë ¥ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

    ```output
    new label count: korean      799
    chinese     799
    indian      799
    japanese    799
    thai        799
    Name: cuisine, dtype: int64
    old label count: korean      799
    indian      598
    chinese     442
    japanese    320
    thai        289
    Name: cuisine, dtype: int64
    ```

    The data is nice and clean, balanced, and very delicious! 
3. ë§ˆì§€ë§‰ ë‹¨ê³„ëŠ” ë ˆì´ë¸” ë° ê¸°ëŠ¥ì„ í¬í•¨í•˜ì—¬ ê· í˜• ì¡íŒ ë°ì´í„°ë¥¼ íŒŒì¼ë¡œ ë‚´ë³´ë‚¼ ìˆ˜ ìˆëŠ” ìƒˆ ë°ì´í„° í”„ë ˆì„ì— ì €ì¥í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

    ```python
    transformed_df = pd.concat([transformed_label_df,transformed_feature_df],axis=1, join='outer')
    ```


4. `transformed_df.head()` ë° `transformed_df.info()`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ í•œ ë²ˆ ë” ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ìˆ˜ì—…ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì´ ë°ì´í„°ì˜ ë³µì‚¬ë³¸ì„ ì €ì¥í•©ë‹ˆë‹¤.

    ```python
    transformed_df.head()
    transformed_df.info()
    transformed_df.to_csv("../data/cleaned_cuisines.csv")
    ```

    This fresh CSV can now be found in the root data folder.

---

## ğŸš€ë„ì „

ì´ ì»¤ë¦¬í˜ëŸ¼ì—ëŠ” ëª‡ ê°€ì§€ í¥ë¯¸ë¡œìš´ ë°ì´í„° ì„¸íŠ¸ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. `data` í´ë”ë¥¼ ì‚´í´ë³´ê³  ë°”ì´ë„ˆë¦¬ ë˜ëŠ” ë‹¤ì¤‘ í´ë˜ìŠ¤ ë¶„ë¥˜ì— ì í•©í•œ ë°ì´í„° ì„¸íŠ¸ê°€ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ì‹­ì‹œì˜¤. ì´ ë°ì´í„°ì„¸íŠ¸ì— ëŒ€í•´ ì–´ë–¤ ì§ˆë¬¸ì„ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?

## [Post-lecture quiz](https://white-water-09ec41f0f.azurestaticapps.net/quiz/20/)

## ë³µìŠµ ë° ë…í•™

SMOTEì˜ APIë¥¼ ì‚´í´ë³´ì„¸ìš”. ì–´ë–¤ ì‚¬ìš© ì‚¬ë¡€ì— ê°€ì¥ ì˜ ì‚¬ìš©ë©ë‹ˆê¹Œ? ì–´ë–¤ ë¬¸ì œë¥¼ í•´ê²°í•©ë‹ˆê¹Œ?

## Assignment 

[Explore classification methods](assignment.md)
